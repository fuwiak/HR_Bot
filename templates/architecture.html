{% extends "base.html" %}

{% block extra_styles %}
<style>
    .mermaid-container {
        background: #f0f2f5;
        padding: 24px;
        border-radius: 8px;
        margin: 16px 0;
        overflow-x: auto;
        border: 1px solid #e4e6eb;
    }
    
    .tech-stack {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 16px;
        margin-top: 24px;
    }
    
    .tech-card {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #e4e6eb;
        border-left: 4px solid #1877f2;
        transition: all 0.2s;
    }
    
    .tech-card:hover {
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transform: translateY(-2px);
    }
    
    .tech-card h3 {
        font-size: 18px;
        font-weight: 600;
        color: #1877f2;
        margin-bottom: 12px;
    }
    
    .tech-card ul {
        list-style: none;
        padding-left: 0;
    }
    
    .tech-card li {
        padding: 6px 0;
        color: #65676b;
        font-size: 14px;
        line-height: 1.5;
    }
    
    .tech-card li:before {
        content: "‚ñ∏ ";
        color: #1877f2;
        font-weight: bold;
        margin-right: 6px;
    }
</style>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
{% endblock %}

{% block content %}
<div class="content-card">
    <h1>üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã</h1>
    <p class="subtitle">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ HR2137 Bot</p>
    
    <div class="mermaid-container">
        <div class="mermaid">
graph TB
    subgraph "–í—Ö–æ–¥–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ª–∏–¥–æ–≤"
        HRTime[HR Time API]
        Email[Yandex Email<br/>IMAP/SMTP]
        Website[–°–∞–π—Ç-–≤–∏–∑–∏—Ç–∫–∞<br/>Webhook]
    end
    
    subgraph "Telegram Bot - Async Hub"
        Bot[Telegram Bot<br/>Async Handlers]
        WebUI[–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å<br/>–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏]
    end
    
    subgraph "LLM –°–ª–æ–π"
        DeepSeek[DeepSeek Chat<br/>—á–µ—Ä–µ–∑ OpenRouter<br/>–û—Å–Ω–æ–≤–Ω–æ–π]
        GigaChat[GigaChat<br/>Fallback<br/>–†–æ—Å—Å–∏–π—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ]
    end
    
    subgraph "RAG –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π"
        Qdrant[Qdrant OSS<br/>–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î]
        QwenEmbed[Qwen2.5<br/>–¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤]
        KnowledgeBase[–î–æ–∫—É–º–µ–Ω—Ç—ã<br/>Word/Excel/PDF]
    end
    
    subgraph "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
        Weeek[WEEEK API<br/>–ü—Ä–æ–µ–∫—Ç—ã/–ó–∞–¥–∞—á–∏]
    end
    
    HRTime -->|Async polling| Bot
    Email -->|Async polling| Bot
    Website -->|Webhook| Bot
    
    Bot -->|Async requests| DeepSeek
    DeepSeek -->|Fallback| GigaChat
    
    Bot -->|Semantic search| Qdrant
    QwenEmbed -->|–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤| Qdrant
    KnowledgeBase -->|–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è| Qdrant
    
    Qdrant -->|RAG –∫–æ–Ω—Ç–µ–∫—Å—Ç| Bot
    Bot -->|–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤| Weeek
    Bot -->|–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è| WebUI
        </div>
    </div>
    
    <div class="tech-stack">
        <div class="tech-card">
            <h3>LLM –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤</h3>
            <ul>
                <li>Primary: DeepSeek Chat (OpenRouter)</li>
                <li>Fallback: GigaChat</li>
            </ul>
        </div>
        <div class="tech-card">
            <h3>–≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è RAG</h3>
            <ul>
                <li>–ú–æ–¥–µ–ª—å: Qwen2.5-1.5B-Instruct</li>
                <li>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: transformers + torch</li>
            </ul>
        </div>
        <div class="tech-card">
            <h3>–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î</h3>
            <ul>
                <li>Qdrant Opensource</li>
                <li>Self-hosted</li>
            </ul>
        </div>
        <div class="tech-card">
            <h3>–í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫</h3>
            <ul>
                <li>FastAPI</li>
                <li>Uvicorn</li>
            </ul>
        </div>
        <div class="tech-card">
            <h3>Telegram Bot</h3>
            <ul>
                <li>python-telegram-bot</li>
                <li>Async handlers</li>
                <li>Webhook/Polling</li>
            </ul>
        </div>
        <div class="tech-card">
            <h3>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</h3>
            <ul>
                <li>WEEEK API</li>
                <li>Yandex Email</li>
                <li>HR Time API</li>
            </ul>
        </div>
    </div>
</div>

<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        themeVariables: {
            primaryColor: '#1877f2',
            primaryTextColor: '#1c1e21',
            primaryBorderColor: '#1877f2',
            lineColor: '#8b9dc3',
            secondaryColor: '#f0f2f5',
            tertiaryColor: '#fff'
        }
    });
</script>
{% endblock %}
