# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞–º–µ—Ä–µ–Ω–∏–π –¥–ª—è HR2137_bot

## –û–ø–∏—Å–∞–Ω–∏–µ

–£–ª—É—á—à–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞–º–µ—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –∑–∞–ø–∏—Å—å:

1. **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏** - —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
2. **–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞** - fallback –º–µ—Ç–æ–¥ –¥–ª—è –±–∞–∑–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **LLM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)** - multi-agent –ø–æ–¥—Ö–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenRouter API

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ –õ—É—á—à–µ –ø–æ–Ω–∏–º–∞–µ—Ç –æ–ø–µ—á–∞—Ç–∫–∏ –∏ —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä—É—Å—Å–∫–∏–º —è–∑—ã–∫–æ–º
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–µ–≥–∫–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ LLM –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install sentence-transformers numpy
```

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LLM –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω—É–∂–µ–Ω OpenRouter API –∫–ª—é—á (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ).

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏

### –≠–º–±–µ–¥–¥–∏–Ω–≥–∏

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **`cointegrated/rubert-tiny2`** - –æ—á–µ–Ω—å –ª–µ–≥–∫–∞—è —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–∞—è –º–æ–¥–µ–ª—å:
- –†–∞–∑–º–µ—Ä: ~30 MB
- –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–∞–±–æ—Ç–∞
- –•–æ—Ä–æ—à–æ –ø–æ–Ω–∏–º–∞–µ—Ç —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `intent_classifier.py`):
- `sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2` - –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–∞—è, –ª–µ–≥–∫–∞—è
- `intfloat/multilingual-e5-small` - –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–∞—è, —Å—Ä–µ–¥–Ω—è—è

### LLM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `x-ai/grok-4.1-fast:free` —á–µ—Ä–µ–∑ OpenRouter API –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤.

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ì–∏–±—Ä–∏–¥–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (–æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥)

```python
from intent_classifier import is_booking_intent

is_booking, details = is_booking_intent(
    text="–∑–∞–≤—Ç—Ä–∞ –≤ 8 —É—Ç—Ä–∞",
    services=services_list,
    masters=masters_list,
    threshold=0.4
)
```

**–ú–µ—Ç–æ–¥—ã:**
- **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏ (50%)** - —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (30%)** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–ª–æ–≤ "–∑–∞–ø–∏—Å—å", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è" –∏ —Ç.–¥.
- **–£—Å–ª—É–≥–∏ (10%)** - —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–π —É—Å–ª—É–≥
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã (10%)** - –Ω–∞–ª–∏—á–∏–µ –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏

### 2. LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω LLM, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è:
- **LLM (60%)** - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –º–µ—Ç–æ–¥ (40%)** - —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ + –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from intent_classifier import is_booking_intent

# –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å
is_booking, details = is_booking_intent("—Ö–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è")
# is_booking = True, details['final_score'] = 0.85

# –° –æ–ø–µ—á–∞—Ç–∫–∞–º–∏
is_booking, details = is_booking_intent("–∑–∞–ø–∏—Å–∞—Ü—Ü–∞ –Ω–∞ –∑–∞–≤—Ç—Ä–∞")
# is_booking = True, details['final_score'] = 0.72

# –ù–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –∑–∞–ø–∏—Å—å
is_booking, details = is_booking_intent("–ø—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?")
# is_booking = False, details['final_score'] = 0.15
```

### –° LLM

```python
from intent_classifier import is_booking_intent

is_booking, details = is_booking_intent(
    text="–º–æ–∂–µ—Ç –±—ã—Ç—å –º–æ–∂–Ω–æ –∫–∞–∫-—Ç–æ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è?",
    services=services_list,
    masters=masters_list,
    threshold=0.4,
    use_llm=True,
    openrouter_api_key="your-key",
    openrouter_url="https://openrouter.ai/api/v1/chat/completions"
)
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ app.py

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `app.py`:

```python
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥
from intent_classifier import is_booking_intent

is_booking_result, intent_details = is_booking_intent(
    text, 
    services=services_list, 
    masters=masters_list, 
    threshold=0.4,
    use_llm=bool(OPENROUTER_API_KEY),  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LLM –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
    openrouter_api_key=OPENROUTER_API_KEY,
    openrouter_url=OPENROUTER_API_URL
)
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–∞

–ü–æ—Ä–æ–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: **0.4** (40% —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏)

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:
- **0.3** - –±–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π (–±–æ–ª—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)
- **0.5** - –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π (–º–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π, –Ω–æ –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã)

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–≠–º–±–µ–¥–¥–∏–Ω–≥–∏**: ~10-50ms –Ω–∞ –∑–∞–ø—Ä–æ—Å (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏)
- **LLM**: ~500-2000ms –Ω–∞ –∑–∞–ø—Ä–æ—Å (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç API)
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –º–µ—Ç–æ–¥**: ~20-100ms –Ω–∞ –∑–∞–ø—Ä–æ—Å

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã:

```
üéØ INTENT CLASSIFICATION: '–∑–∞–≤—Ç—Ä–∞ –≤ 8 —É—Ç—Ä–∞' -> score=0.752, is_booking=True, method=hybrid
üéØ INTENT CLASSIFIER: score=0.752, method=hybrid
```

## –û—Ç–ª–∞–¥–∫–∞

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

```python
is_booking, details = is_booking_intent(text, services, masters)

print(f"Method: {details['method']}")
print(f"Final score: {details['final_score']}")
print(f"Embedding score: {details.get('embedding', {}).get('confidence', 0)}")
print(f"Keyword score: {details.get('keyword_score', 0)}")
print(f"Service score: {details.get('service_score', 0)}")
print(f"Time score: {details.get('time_score', 0)}")
```

## Troubleshooting

### –û—à–∏–±–∫–∞: "sentence-transformers –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"

```bash
pip install sentence-transformers
```

### –û—à–∏–±–∫–∞: "numpy –Ω–µ –Ω–∞–π–¥–µ–Ω"

```bash
pip install numpy
```

### –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –º–æ–¥–µ–ª—å —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∏–∑ HuggingFace (~30-100 MB).

### –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–∏–∑–∏—Ç—å –ø–æ—Ä–æ–≥: `threshold=0.3`
2. –í–∫–ª—é—á–∏—Ç–µ LLM –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é: `use_llm=True`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] Fine-tuning –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤
- [ ] –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –¥—Ä—É–≥–∏—Ö –Ω–∞–º–µ—Ä–µ–Ω–∏–π (–≤–æ–ø—Ä–æ—Å—ã, –æ—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏ –∏ —Ç.–¥.)






