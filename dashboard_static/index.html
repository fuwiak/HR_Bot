<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kaspersky RAG Dashboard | Retro Terminal</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="terminal">
        <!-- Header -->
        <div class="terminal-header">
            <div class="terminal-title">
                <span class="blink">‚ñà</span> KASPERSKY RAG DASHBOARD v1.0
            </div>
            <div class="terminal-time" id="current-time"></div>
        </div>

        <!-- Main Content -->
        <div class="terminal-body">
            <!-- Navigation Tabs -->
            <div class="tabs">
                <button class="tab-btn active" data-tab="overview">üìä –û–ë–ó–û–†</button>
                <button class="tab-btn" data-tab="vectordb">üóÑÔ∏è –í–ï–ö–¢–û–†–ù–ê–Ø –ë–î</button>
                <button class="tab-btn" data-tab="metrics">üìà –ú–ï–¢–†–ò–ö–ò</button>
                <button class="tab-btn" data-tab="workflow">‚öôÔ∏è WORKFLOW</button>
                <button class="tab-btn" data-tab="files">üìÅ –§–ê–ô–õ–´</button>
                <button class="tab-btn" data-tab="test">üß™ –¢–ï–°–¢</button>
            </div>

            <!-- Tab Content -->
            <div class="tab-content active" id="overview">
                <div class="panel">
                    <h2 class="panel-title">–°–ò–°–¢–ï–ú–ù–´–ô –°–¢–ê–¢–£–°</h2>
                    <div class="status-grid">
                        <div class="status-card">
                            <div class="status-label">–í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î</div>
                            <div class="status-value" id="vectordb-status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                        <div class="status-card">
                            <div class="status-label">–î–æ–∫—É–º–µ–Ω—Ç–æ–≤</div>
                            <div class="status-value" id="vectordb-count">-</div>
                        </div>
                        <div class="status-card">
                            <div class="status-label">–ü–æ—Å–ª–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞</div>
                            <div class="status-value" id="last-eval-time">-</div>
                        </div>
                        <div class="status-card">
                            <div class="status-label">Precision@K</div>
                            <div class="status-value" id="precision-k">-</div>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <h2 class="panel-title">–ë–´–°–¢–†–´–ï –î–ï–ô–°–¢–í–ò–Ø</h2>
                    <div class="button-grid">
                        <button class="retro-btn" onclick="runEvaluation()">‚ñ∂ –ó–ê–ü–£–°–¢–ò–¢–¨ –û–¶–ï–ù–ö–£</button>
                        <button class="retro-btn" onclick="loadPDF()">üìÑ –ó–ê–ì–†–£–ó–ò–¢–¨ PDF</button>
                        <button class="retro-btn" onclick="scrapeWebsites()">üåê –°–ö–†–ê–ü–ò–¢–¨ –°–ê–ô–¢–´</button>
                        <button class="retro-btn" onclick="refreshData()">üîÑ –û–ë–ù–û–í–ò–¢–¨</button>
                        <button class="retro-btn" onclick="switchTab('test')">üß™ –¢–ï–°–¢–û–í–´–ô –ó–ê–ü–†–û–°</button>
                    </div>
                </div>
            </div>

            <!-- Vector DB Tab -->
            <div class="tab-content" id="vectordb">
                <div class="panel">
                    <h2 class="panel-title">–ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–ï–ö–¢–û–†–ù–û–ô –ë–î</h2>
                    <div class="info-table">
                        <div class="info-row">
                            <span class="info-label">–ö–æ–ª–ª–µ–∫—Ü–∏—è:</span>
                            <span class="info-value" id="collection-name">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–î–æ–∫—É–º–µ–Ω—Ç–æ–≤:</span>
                            <span class="info-value" id="points-count">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–í–µ–∫—Ç–æ—Ä–æ–≤:</span>
                            <span class="info-value" id="vectors-count">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="info-value" id="collection-status">-</span>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <h2 class="panel-title">–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•</h2>
                    <div class="sources-list" id="sources-list">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤...</div>
                    </div>
                </div>
            </div>

            <!-- Metrics Tab -->
            <div class="tab-content" id="metrics">
                <div class="panel">
                    <h2 class="panel-title">–¢–ï–ö–£–©–ò–ï –ú–ï–¢–†–ò–ö–ò RAG</h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-label">Precision@K (–†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ)</div>
                            <div class="metric-value" id="metric-precision-regulated">-</div>
                            <div class="metric-target">–¶–µ–ª—å: ‚â•0.85</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Precision@K (–û–±—â–∏–µ)</div>
                            <div class="metric-value" id="metric-precision-general">-</div>
                            <div class="metric-target">–¶–µ–ª—å: ‚â•0.75</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">MRR</div>
                            <div class="metric-value" id="metric-mrr">-</div>
                            <div class="metric-target">–¶–µ–ª—å: ‚â•0.9</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Groundedness</div>
                            <div class="metric-value" id="metric-groundedness">-</div>
                            <div class="metric-target">–¶–µ–ª—å: ‚â•0.9</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">Halucination Rate</div>
                            <div class="metric-value" id="metric-halucination">-</div>
                            <div class="metric-target">–¶–µ–ª—å: ‚â§10%</div>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <h2 class="panel-title">–ò–°–¢–û–†–ò–Ø –ú–ï–¢–†–ò–ö</h2>
                    <div class="history-chart" id="history-chart">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏...</div>
                    </div>
                </div>
            </div>

            <!-- Workflow Tab -->
            <div class="tab-content" id="workflow">
                <div class="panel">
                    <h2 class="panel-title">–£–ü–†–ê–í–õ–ï–ù–ò–ï WORKFLOW</h2>
                    <div class="workflow-section">
                        <h3>1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                        <div class="workflow-item">
                            <button class="retro-btn" onclick="loadPDF()">–ó–∞–≥—Ä—É–∑–∏—Ç—å PDF</button>
                            <button class="retro-btn" onclick="loadExcel()">–ó–∞–≥—Ä—É–∑–∏—Ç—å Excel</button>
                        </div>
                    </div>
                    <div class="workflow-section">
                        <h3>2. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
                        <div class="workflow-item">
                            <button class="retro-btn primary" onclick="runEvaluation()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ü–µ–Ω–∫—É RAG</button>
                            <div class="workflow-info">
                                –û—Ü–µ–Ω–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Ground-Truth QA –Ω–∞–±–æ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–µ—Ç—Ä–∏–∫
                            </div>
                        </div>
                    </div>
                    <div class="workflow-section">
                        <h3>3. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
                        <div class="workflow-item">
                            <button class="retro-btn" onclick="switchTab('metrics')">–ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫</button>
                            <button class="retro-btn" onclick="exportResults()">–≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Files Tab -->
            <div class="tab-content" id="files">
                <div class="panel">
                    <h2 class="panel-title">–£–ü–†–ê–í–õ–ï–ù–ò–ï –§–ê–ô–õ–ê–ú–ò</h2>
                    <div class="file-upload-area" id="file-upload-area">
                        <input type="file" id="file-input" accept=".pdf,.xlsx,.xls" style="display: none;" onchange="handleFileSelect(event)">
                        <div class="upload-box" onclick="document.getElementById('file-input').click()">
                            <div class="upload-icon">üìÅ</div>
                            <div class="upload-text">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞</div>
                            <div class="upload-hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: PDF, Excel</div>
                        </div>
                    </div>
                    <div class="files-list" id="files-list">
                        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤...</div>
                    </div>
                </div>
            </div>

            <!-- Test Tab -->
            <div class="tab-content" id="test">
                <div class="panel">
                    <h2 class="panel-title">–¢–ï–°–¢–û–í–´–ô –ó–ê–ü–†–û–° –ö RAG</h2>
                    <div class="test-query-form">
                        <input type="text" class="retro-input" id="test-query-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...">
                        <button class="retro-btn primary" onclick="testQuery()">‚ñ∂ –í–´–ü–û–õ–ù–ò–¢–¨</button>
                    </div>
                    <div class="test-result" id="test-result">
                        <div class="result-placeholder">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="terminal-footer">
            <span class="footer-text">Kaspersky RAG System | Status: <span id="system-status">ONLINE</span></span>
        </div>
    </div>

    <!-- –í—ã–¥–≤–∏–≥–∞—é—â–∞—è—Å—è –ø–∞–Ω–µ–ª—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª) -->
    <div class="params-panel" id="params-panel">
        <div class="params-panel-header" onclick="toggleParamsPanel()">
            <span class="params-panel-title">‚öôÔ∏è –ü–ê–†–ê–ú–ï–¢–†–´ RAG</span>
            <span class="params-panel-toggle" id="params-toggle">‚ñº</span>
        </div>
        <div class="params-panel-content" id="params-content">
            <div class="param-group">
                <label class="param-label">
                    <span>–†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ (chunk_size)</span>
                    <span class="param-value" id="chunk-size-value">500</span>
                </label>
                <input type="range" class="param-slider" id="chunk-size" min="100" max="2000" value="500" step="50">
            </div>
            <div class="param-group">
                <label class="param-label">
                    <span>–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —á–∞–Ω–∫–æ–≤ (chunk_overlap)</span>
                    <span class="param-value" id="chunk-overlap-value">50</span>
                </label>
                <input type="range" class="param-slider" id="chunk-overlap" min="0" max="500" value="50" step="10">
            </div>
            <div class="param-group">
                <label class="param-label">
                    <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (top_k)</span>
                    <span class="param-value" id="top-k-value">10</span>
                </label>
                <input type="range" class="param-slider" id="top-k" min="1" max="50" value="10" step="1">
            </div>
            <div class="param-group">
                <label class="param-label">
                    <span>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score (min_score)</span>
                    <span class="param-value" id="min-score-value">0.3</span>
                </label>
                <input type="range" class="param-slider" id="min-score" min="0" max="1" value="0.3" step="0.05">
            </div>
            <div class="param-group">
                <label class="param-label">
                    <span>–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ LLM (temperature)</span>
                    <span class="param-value" id="temperature-value">0.7</span>
                </label>
                <input type="range" class="param-slider" id="temperature" min="0" max="2" value="0.7" step="0.1">
            </div>
            <div class="param-group">
                <label class="param-label">
                    <span>–ú–∞–∫—Å. —Ç–æ–∫–µ–Ω–æ–≤ (max_tokens)</span>
                    <span class="param-value" id="max-tokens-value">2048</span>
                </label>
                <input type="range" class="param-slider" id="max-tokens" min="256" max="4096" value="2048" step="256">
            </div>
            <div class="param-actions">
                <button class="retro-btn primary" onclick="applyParameters()">‚ñ∂ –ü–†–ò–ú–ï–ù–ò–¢–¨</button>
                <button class="retro-btn" onclick="resetParameters()">üîÑ –°–ë–†–û–°</button>
            </div>
        </div>
    </div>

    <!-- –ê—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∑–≤—É–∫–æ–≤ -->
    <audio id="click-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp3pVECBBZru3xpmE=" type="audio/wav">
    </audio>

    <script src="/static/script.js"></script>
</body>
</html>

