# üîß –§–ò–ù–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤

## –ü—Ä–æ–±–ª–µ–º–∞

```
Vector dimension error: expected dim: 1536, got 1024
```

### –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã

1. **–ö–æ–ª–ª–µ–∫—Ü–∏—è –≤ Qdrant —Å–æ–∑–¥–∞–Ω–∞ —Å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é 1536** (–¥–ª—è OpenAI text-embedding-3-small)
2. **OpenRouter Qwen3-Embedding-8B –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å 1024**
3. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ Qdrant**

---

## –†–µ—à–µ–Ω–∏–µ

### 1. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç OpenAI API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

**–ò–∑–º–µ–Ω–µ–Ω–æ –≤ `qdrant_helper.py`:**

```python
# –ë–´–õ–û: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç OpenRouter
if OPENROUTER_API_KEY:
    EMBEDDING_MODEL = "qwen/qwen3-embedding-8b"
    EMBEDDING_DIMENSION = 1024

# –°–¢–ê–õ–û: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç OpenAI (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π)
if OPENAI_API_KEY:
    EMBEDDING_MODEL = "text-embedding-3-small"
    EMBEDDING_DIMENSION = 1536  ‚úÖ
elif OPENROUTER_API_KEY:
    EMBEDDING_MODEL = "qwen/qwen3-embedding-8b"
    EMBEDDING_DIMENSION = 1536  # –¶–µ–ª–µ–≤–∞—è (–±—É–¥–µ—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω)
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤

**–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 1024, –∞ –Ω—É–∂–Ω–æ 1536:**

```python
embedding_size = len(embedding)  # 1024
target_dimension = 1536

if embedding_size < target_dimension:
    padding_size = target_dimension - embedding_size  # 512
    embedding = embedding + [0.0] * padding_size
    log.info(f"üìå –î–æ–ø–æ–ª–Ω–µ–Ω–æ: 1024 ‚Üí 1536 (+512 –Ω—É–ª–µ–π)")
```

### 3. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```python
# –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º
if len(embedding) != _embedding_dimension:
    log.error(f"‚ùå –û–®–ò–ë–ö–ê: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å {len(embedding)} != {_embedding_dimension}")
    return None

return embedding  # –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ .env

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π):

```bash
OPENAI_API_KEY=your_openai_key_here
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSION=1536
```

### ‚ö†Ô∏è –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ OpenRouter:

```bash
OPENROUTER_API_KEY=your_openrouter_key_here
EMBEDDING_MODEL=qwen/qwen3-embedding-8b
EMBEDDING_DIMENSION=1536  # –í–∞–∂–Ω–æ! –¶–µ–ª–µ–≤–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í–µ–∫—Ç–æ—Ä–∞ 1024 –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –¥–æ 1536 –Ω—É–ª—è–º–∏.

---

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ò–∑–º–µ–Ω–µ–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç API

**–î–æ:**
```python
if OPENROUTER_API_KEY:  # –ü–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚ùå
    # 1024 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
elif OPENAI_API_KEY:
    # 1536 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
```

**–ü–æ—Å–ª–µ:**
```python
if OPENAI_API_KEY:  # –ü–µ—Ä–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚úÖ
    # 1536 —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π)
elif OPENROUTER_API_KEY:
    # 1024 ‚Üí 1536 (–¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Ü–µ–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏

```python
TARGET_DIMENSION = 1536  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Qdrant
```

### 3. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
log.warning(f"‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenRouter (–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: 1024)")
log.warning(f"‚ö†Ô∏è –í–µ–∫—Ç–æ—Ä–∞ –±—É–¥—É—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –¥–æ {TARGET_DIMENSION}")
log.info(f"üìå –≠–º–±–µ–¥–¥–∏–Ω–≥ –¥–æ–ø–æ–ª–Ω–µ–Ω: 1024 ‚Üí 1536 (+512 –Ω—É–ª–µ–π)")
```

### 4. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º

```python
if len(embedding) != _embedding_dimension:
    log.error(f"‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å {len(embedding)}")
    return None
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –£–∑–Ω–∞—Ç—å —Ç–µ–∫—É—â—É—é –º–æ–¥–µ–ª—å –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å:

```python
from qdrant_helper import EMBEDDING_MODEL, EMBEDDING_DIMENSION, OPENAI_API_KEY, OPENROUTER_API_KEY

print(f"–ú–æ–¥–µ–ª—å: {EMBEDDING_MODEL}")
print(f"–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: {EMBEDDING_DIMENSION}")
print(f"OpenAI API: {'‚úÖ' if OPENAI_API_KEY else '‚ùå'}")
print(f"OpenRouter API: {'‚úÖ' if OPENROUTER_API_KEY else '‚ùå'}")
```

### –£–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏:

```python
from qdrant_helper import get_qdrant_client

client = get_qdrant_client()
collection = client.get_collection("hr2137_bot_knowledge_base")
print(f"–ö–æ–ª–ª–µ–∫—Ü–∏—è: {collection.config.params.vectors.size}")
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç —Å OpenAI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```bash
# .env
OPENAI_API_KEY=sk-xxx
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
üîß –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenAI API (–º–æ–¥–µ–ª—å: text-embedding-3-small, —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: 1536)
‚úÖ –≠–º–±–µ–¥–¥–∏–Ω–≥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: 1536)
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 25 —á–∞–Ω–∫–æ–≤ –≤ Qdrant
```

### –¢–µ—Å—Ç —Å OpenRouter (—Å –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º):

```bash
# .env
OPENROUTER_API_KEY=sk-xxx
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenRouter (–º–æ–¥–µ–ª—å: qwen/qwen3-embedding-8b, –Ω–∞—Ç–∏–≤–Ω–∞—è: 1024)
‚ö†Ô∏è –í–µ–∫—Ç–æ—Ä–∞ –±—É–¥—É—Ç –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –¥–æ 1536
üìå –≠–º–±–µ–¥–¥–∏–Ω–≥ –¥–æ–ø–æ–ª–Ω–µ–Ω: 1024 ‚Üí 1536 (+512 –Ω—É–ª–µ–π)
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ 25 —á–∞–Ω–∫–æ–≤ –≤ Qdrant
```

---

## –í–ª–∏—è–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –Ω—É–ª—è–º–∏

### –ü–ª—é—Å—ã:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–π –º–æ–¥–µ–ª—å—é
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –ú–∏–Ω—É—Å—ã:
- ‚ö†Ô∏è –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω—É–ª–∏ –Ω–µ –Ω–µ—Å—É—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —Å–Ω–∏–∑–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞
- ‚ö†Ô∏è –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –º–æ–¥–µ–ª–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ OpenAI —Å `text-embedding-3-small` (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π)

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** OpenRouter —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenRouter –±–µ–∑ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è:

### 1. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é:

```python
from qdrant_helper import get_qdrant_client

client = get_qdrant_client()
client.delete_collection("hr2137_bot_knowledge_base")
```

### 2. –ò–∑–º–µ–Ω–∏—Ç–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å:

```bash
# .env
OPENROUTER_API_KEY=your_key
EMBEDDING_DIMENSION=1024  # –ù–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å Qwen
```

### 3. –ö–æ–ª–ª–µ–∫—Ü–∏—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ

---

## –ò—Ç–æ–≥–æ

‚úÖ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç OpenAI API** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω) ‚Äî —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤** –¥–æ —Ü–µ–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏  
‚úÖ **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º  
‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏  
‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–π –º–æ–¥–µ–ª—å—é** (OpenAI, OpenRouter, –∏ –¥—Ä.)  
‚úÖ **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —Å –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π –≤ Qdrant  

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ! üéâ**
