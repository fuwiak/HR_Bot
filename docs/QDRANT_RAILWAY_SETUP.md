# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Qdrant –≤ Railway

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ç–æ–ª—å–∫–æ Railway Qdrant** (–±–µ–∑ Qdrant Cloud). –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Railway Qdrant –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è RAG –ø–æ–∏—Å–∫–∞ –≤ LLM –æ—Ç–≤–µ—Ç–∞—Ö.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram   ‚îÇ
‚îÇ     Bot     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îú‚îÄ‚ñ∫ Redis (–±—ã—Å—Ç—Ä–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
       ‚îÇ   ‚îî‚îÄ‚ñ∫ PostgreSQL (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
       ‚îÇ       ‚îî‚îÄ‚ñ∫ –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
       ‚îÇ
       ‚îî‚îÄ‚ñ∫ Qdrant (Railway) ‚îÄ‚îÄ‚ñ∫ –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
           ‚îî‚îÄ‚ñ∫ –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
           ‚îî‚îÄ‚ñ∫ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ LLM –¥–ª—è RAG –æ—Ç–≤–µ—Ç–æ–≤
```

### Flow –¥–∞–Ω–Ω—ã—Ö:

1. **Telegram —Å–æ–æ–±—â–µ–Ω–∏—è:**
   - –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí Redis ‚Üí PostgreSQL
   - –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Redis/PostgreSQL

2. **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π:**
   - –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Qdrant (Railway)
   - –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –ø–æ–∏—Å–∫ –≤ Qdrant ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ LLM –ø—Ä–æ–º–ø—Ç ‚Üí –æ—Ç–≤–µ—Ç

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Railway

### 1. Qdrant —Å–µ—Ä–≤–∏—Å –≤ Railway

–í —Å–µ—Ä–≤–∏—Å–µ **Qdrant** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```bash
DATABASE_URL="${{Postgres.DATABASE_URL}}"
PORT="6333"
```

### 2. HR_Bot —Å–µ—Ä–≤–∏—Å –≤ Railway

–í —Å–µ—Ä–≤–∏—Å–µ **HR_Bot** –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Qdrant:

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Railway Qdrant —Å–µ—Ä–≤–∏—Å—É
QDRANT_HOST="<private-domain-qdrant-service>"  # Private domain Qdrant —Å–µ—Ä–≤–∏—Å–∞ –∏–∑ Railway
QDRANT_PORT="6333"  # –ü–æ—Ä—Ç Qdrant (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 6333)
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å QDRANT_HOST:**

1. –í Railway Dashboard –æ—Ç–∫—Ä–æ–π—Ç–µ Qdrant —Å–µ—Ä–≤–∏—Å
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Networking
3. –ù–∞–π–¥–∏—Ç–µ **Private Domain** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `qdrant-production.up.railway.app`)
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–º–µ–Ω –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–∞–∫ `QDRANT_HOST` –≤ HR_Bot —Å–µ—Ä–≤–∏—Å–µ

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ Service Reference):**

–ï—Å–ª–∏ –≤ Railway –Ω–∞—Å—Ç—Ä–æ–µ–Ω Service Reference –¥–ª—è Qdrant, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- `QDRANT_HOST` –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Railway
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–∏–ø–∞ `QDRANT_PRIVATE_DOMAIN`

### 3. –£–¥–∞–ª–µ–Ω–∏–µ Qdrant Cloud –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–£–¥–∞–ª–∏—Ç–µ –∏–∑ HR_Bot —Å–µ—Ä–≤–∏—Å–∞:**
- ‚ùå `QDRANT_URL` (—Å—Ç–∞—Ä—ã–π Qdrant Cloud URL)
- ‚ùå `QDRANT_API_KEY` (—Å—Ç–∞—Ä—ã–π Qdrant Cloud API –∫–ª—é—á)

**–û—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ:**
- ‚úÖ `QDRANT_HOST` (private domain Qdrant —Å–µ—Ä–≤–∏—Å–∞)
- ‚úÖ `QDRANT_PORT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 6333)

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ Railway Qdrant –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.

–í –ª–æ–≥–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üîß –û–±–Ω–∞—Ä—É–∂–µ–Ω Railway Qdrant —Å–µ—Ä–≤–∏—Å: http://<host>:6333
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Railway Qdrant: http://<host>:6333
üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Railway Qdrant: http://<host>:6333
‚úÖ Qdrant –∫–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Railway Qdrant (–æ—Å–Ω–æ–≤–Ω–∞—è –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–ª—è RAG)
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Qdrant –≤ LLM

Qdrant –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:

1. **RAG –ø–æ–∏—Å–∫** (`/rag_search` –∫–æ–º–∞–Ω–¥–∞):
   - –ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã** (—Ñ—É–Ω–∫—Ü–∏—è `reply`):
   - –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –ø–æ–∏—Å–∫ –≤ Qdrant
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ LLM –ø—Ä–æ–º–ø—Ç
   - LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

3. **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**:
   - –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Qdrant
   - –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ Qdrant

## Troubleshooting

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Qdrant

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É:
```
‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Qdrant
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. ‚úÖ Qdrant —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω –≤ Railway
2. ‚úÖ `QDRANT_HOST` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ HR_Bot —Å–µ—Ä–≤–∏—Å–µ
3. ‚úÖ `QDRANT_PORT` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 6333)
4. ‚úÖ Qdrant —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ HR_Bot —Å–µ—Ä–≤–∏—Å–∞ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å Railway)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–í Railway Dashboard ‚Üí HR_Bot ‚Üí Variables –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- ‚úÖ `QDRANT_HOST` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ `QDRANT_PORT` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 6333
- ‚ùå `QDRANT_URL` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–¥–∞–ª–µ–Ω
- ‚ùå `QDRANT_API_KEY` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–¥–∞–ª–µ–Ω

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ Qdrant –ª–æ–∫–∞–ª—å–Ω–æ
docker run -p 6333:6333 qdrant/qdrant

# –í .env —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
QDRANT_HOST="localhost"
QDRANT_PORT="6333"
```

–ò–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ `QDRANT_HOST`, —Ç–æ–≥–¥–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `http://localhost:6333` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
