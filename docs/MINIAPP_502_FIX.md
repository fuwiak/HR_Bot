# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 502 –≤ Mini App

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

Mini App –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 502 Bad Gateway:
```
https://mini-app-production-153f.up.railway.app/ ‚Üí 502 error
```

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Dockerfile Path** –≤ Railway
2. **–ü–æ—Ä—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω** –≤ Railway
3. **–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏** Next.js
4. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Dockerfile Path –≤ Railway

**Mini App —Å–µ—Ä–≤–∏—Å ‚Üí Settings ‚Üí Build ‚Üí Dockerfile Path:**

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
frontend/Dockerfile
```

–ò–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≥–ª–∞–≤–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥:
```
Dockerfile.frontend
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Port –≤ Railway

**Mini App —Å–µ—Ä–≤–∏—Å ‚Üí Settings ‚Üí Networking ‚Üí Port:**

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
3000
```

### 3. –£–±–µ—Ä–∏—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ Mini App

**Mini App –ù–ï –Ω—É–∂–Ω—ã:**
- ‚ùå `DATABASE_URL` - —Ç–æ–ª—å–∫–æ –¥–ª—è backend
- ‚ùå `QDRANT_HOST` - —Ç–æ–ª—å–∫–æ –¥–ª—è backend
- ‚ùå `TELEGRAM_TOKEN` - —Ç–æ–ª—å–∫–æ –¥–ª—è Telegram Bot

**Mini App –Ω—É–∂–Ω—ã –¢–û–õ–¨–ö–û:**
```env
PORT=3000
NODE_ENV=production
NEXT_PUBLIC_API_URL=https://hrbot-production-f67c.up.railway.app
BACKEND_URL=https://hrbot-production-f67c.up.railway.app
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏

–í Railway Dashboard ‚Üí Mini App ‚Üí Deployments ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π deployment ‚Üí Logs

–ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏:
- `npm ci` - –æ—à–∏–±–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `npm run build` - –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏ Next.js
- `node server.js` - –æ—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ @twa-dev/sdk —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

–í –ª–æ–≥–∞—Ö —Å–±–æ—Ä–∫–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
added 1 package, and audited X packages
```

–ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `package.json` –∏ `package-lock.json`

## üõ† –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Dockerfile Path –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

**–°–∏–º–ø—Ç–æ–º:** 502 error, –≤ –ª–æ–≥–∞—Ö –Ω–µ—Ç "Starting Container"

**–†–µ—à–µ–Ω–∏–µ:** 
- Settings ‚Üí Build ‚Üí Dockerfile Path: `frontend/Dockerfile`
- –ò–ª–∏: `Dockerfile.frontend` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≥–ª–∞–≤–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Port –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

**–°–∏–º–ø—Ç–æ–º:** 502 error, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- Settings ‚Üí Networking ‚Üí Port: `3000`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –µ—Å—Ç—å `PORT=3000`

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏

**–°–∏–º–ø—Ç–æ–º:** Deployment failed, –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö —Å–±–æ—Ä–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `@twa-dev/sdk` –≤ `package.json`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å TypeScript

### –ü—Ä–æ–±–ª–µ–º–∞ 4: server.js –Ω–µ –Ω–∞–π–¥–µ–Ω

**–°–∏–º–ø—Ç–æ–º:** `Error: Cannot find module './server.js'`

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `next.config.js` –∏–º–µ–µ—Ç `output: 'standalone'`
- –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìã –ß–µ–∫–ª–∏—Å—Ç

- [ ] Dockerfile Path: `frontend/Dockerfile` –∏–ª–∏ `Dockerfile.frontend`
- [ ] Port: `3000` –≤ Settings ‚Üí Networking
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: —Ç–æ–ª—å–∫–æ `PORT`, `NODE_ENV`, `NEXT_PUBLIC_API_URL`, `BACKEND_URL`
- [ ] –£–±—Ä–∞–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `DATABASE_URL`, `QDRANT_HOST`, `TELEGRAM_TOKEN`
- [ ] –°–±–æ—Ä–∫–∞ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏)
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ runtime)

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

1. **Build logs:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `npm ci` ‚Üí —É—Å–ø–µ—à–Ω–æ
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `npm run build` ‚Üí —É—Å–ø–µ—à–Ω–æ
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Creating an optimized production build`

2. **Runtime logs:**
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Ready on http://0.0.0.0:3000`
   - –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `Error: Cannot find module`

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL:

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å:
- `https://mini-app-production-153f.up.railway.app/` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- `https://mini-app-production-153f.up.railway.app/miniapp` - Mini App

## üí° –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å: Deployments ‚Üí Redeploy
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ Git
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Railway –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ (main)
